<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>打回修改</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="plugins/datepick/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/base.css">
    <script src="plugins/rem.js"></script>
</head>
<body>
    <!-- wrap -->
    <div class="wrap">
        <!-- bannner -->
        <div class="banner">
            <h1 class="app-title">立讯精密访客预约系统</h1>
        </div>
        <!-- content -->
        <div class="content">
            <!-- tip -->
            <div class="tip tip-warning">
                <i class="icon-tip"></i>
                <span>请完善您的申请被打回，请完善访客信息 申请被打回的原因访客资料！</span>
            </div>
            <!-- card -->
            <div class="card">
                <dl>
                    <dt>
                        <i class="icon-user"></i>
                        <span>被访人</span>
                    </dt>
                    <dd>
                        <span class="name">李工</span>
                        <span class="tel">18273646362</span>
                        <i class="icon-tel"></i>
                    </dd>
                </dl>
                <dl class="time">
                    <dt>
                        <i class="icon-date"></i>
                        <span>预约拜访时间</span>
                    </dt>
                    <dd>
                        <span  id="date-group1" readonly>2020/01/10 星期四 10:00 </span>
                        <span  id="date-group2" readonly>2020/01/10 星期四 10:00 </span>
                    </dd>
                </dl>
            </div>
            <!-- form -->
            <form class="form">
                <dl class="dl-idCard">
                    <dt>
                        <i class="icon-idCard"></i>
                        <span>身份证正面照片</span>
                    </dt>
                    <dd>
                        <div class="tkPhoto-box">
                            <div class="img-box">
                                <img src="img/idCard.jpg" class="idCard">
                                <img src="img/edit_icon.png" class="edit">
                            </div>
                        </div>
                    </dd>
                </dl>
                <dl class="main-visitor">
                    <dt>
                        <span class="title">
                            <i class="icon-user"></i>
                            <span>主访客</span>
                        </span>
                        <i class="icon-delete delete"></i>
                    </dt>
                    <dd>
                        <input type="text" placeholder="姓名">
                        <div class="select-box">
                            <input type="text" placeholder="性别">
                            <ul class="select">
                                <li>男</li>
                                <li>女</li>
                            </ul>
                        </div>
                        <input type="text" placeholder="身份证号">
                        <input type="text" placeholder="手机号">
                        <div class="select-box">
                            <input type="text" placeholder="公司名称">
                            <ul class="select">
                                <li>傲天科技</li>
                                <li>傲天科技有限公司</li>
                            </ul>
                        </div>
                        <input type="text" placeholder="部门/职位">
                    </dd>
                </dl>
                <dl class="goods">
                    <dt>
                        <i class="icon-good"></i>
                        <span>随身物品</span>
                    </dt>
                    <dd>
                        <div class="good-list">
                            <span>手机 x2 <i class="icon-close"></i> </span>
                            <span>笔记本电脑 <i class="icon-close"></i></span>
                        </div>
                        <button type="button" id="addGood">添加物品</button>
                    </dd>
                </dl>
                <button type="button" class="add-visitor">添加访客</button>
            </form>
            <div class="op">
                <button type="button">暂存</button>
                <button type="button">提交</button>
            </div>
            <div class="footer">
                <p class="app-order">订单：9327432885798</p>
                <p class="copyright">本系统由广东源禾智智能科技有限公司开发</p>
            </div>
        </div>
    </div>
    <div class="mask" style="display: none;">
        <!-- 添加物品 -->
        <div class="pop add_good_pop" style="display: none;">
            <dl>
                <dt>
                    <span class="head">
                        <i class="icon-good"></i>
                        <span>随身物品</span>
                    </span>
                    <i class="icon-pop-close" id="close"></i>
                </dt>
                <dd>
                    <form class="pop-form">
                        <input type="text" placeholder="物品">
                        <input type="number" placeholder="数量">
                    </form>
                    <button type="button">确定</button>
                </dd>
            </dl>
        </div>
        <!-- 添加访客 -->
        <div class="pop add_visitor_pop" style="display: none;">
            <dl>
                <dt>
                    <span class="head">
                        <i class="icon-visitor"></i>
                        <span>添加访客</span>
                    </span>
                    <i class="icon-pop-close" id="close"></i>
                </dt>
                <dd>
                    <form class="pop-form">
                        <div class="input-box">
                            <i class="icon-search"></i>
                            <input type="text" placeholder="姓名/手机">
                        </div>
                        <button type="button">新建访客</button>
                        <ul>
                            <li>
                                <p><span class="name">张三丰</span> <span class="status">(已添加)</span></p>
                                <p class="tel">18833336362</p>
                            </li>
                            <li>
                                <p><span class="name">王武</span> <span class="status">(已添加)</span></p>
                                <p class="tel">18833336362</p>
                            </li>
                            <li>
                                <p><span class="name">李四</span></p>
                                <p class="tel">18833336362</p>
                            </li>
                            <li>
                                <p><span class="name">赵建强</span> <span class="status">(已添加)</span></p>
                                <p class="tel">18833336362</p>
                            </li>
                        </ul>
                    </form>
                </dd>
            </dl>
        </div>
    </div>
</body>
<script src="plugins/jquery-2.4-min.js"></script>
<script src="plugins/datepick/js/datepick.js"></script>
<script>
        new Rolldate({
        el: '#date-group1',
        format: 'YYYY-MM-DD hh:mm',
        beginYear: 2000,
        endYear: 2050,
        confirm: function(date) {
            var _date = date.split(' ').join(' '+getMyDay(date)+' ')
            return _date
        },
    })
    new Rolldate({
        el: '#date-group2',
        format: 'YYYY-MM-DD hh:mm',
        beginYear: 2000,
        endYear: 2050,
        confirm: function(date) {
            var _date = date.split(' ').join(' '+getMyDay(date)+' ')
            return _date
        },
    })
    // 判断星期
    function getMyDay(date){
        console.log(date)
        var week,
        _date = date.replace(/-/g,'/');
        myDate = new Date(_date);
        if(myDate.getDay()==0) week="星期日";
        if(myDate.getDay()==1) week="星期一";
        if(myDate.getDay()==2) week="星期二";
        if(myDate.getDay()==3) week="星期三";
        if(myDate.getDay()==4) week="星期四";
        if(myDate.getDay()==5) week="星期五";
        if(myDate.getDay()==6) week="星期六";
        return week;
    }
    //select
    $('.select-box input').focus(function(){
        $(this).next('ul').show(300)
    }).blur(function(){
        $(this).next('ul').hide(300)
    })
    $('.select-box ul li').click(function(){
        $(this).parent().prev().val($(this).text());
    })

    //弹窗
        //添加物品
        $('#addGood').click(function(){
            $('.add_good_pop').show();
            $('.mask').show();
        })
        $('.add_good_pop #close').click(function(){
            $('.add_good_pop').hide();
            $('.mask').hide();
        })

        //添加访客
        $('.add-visitor').click(function(){
            $('.add_visitor_pop').show();
            $('.mask').show();
        })

        $('.add_visitor_pop button').click(function(){
            var _html = `
                    <dt>
                        <span class="title">
                            <i class="icon-user"></i>
                            <span>随访人</span>
                        </span>
                        <i class="icon-delete delete"></i>
                    </dt>
                    <dd>
                        <input type="text" placeholder="姓名">
                        <div class="select-box">
                            <input type="text" placeholder="性别">
                            <ul class="select">
                                <li>男</li>
                                <li>女</li>
                            </ul>
                        </div>
                        <input type="text" placeholder="身份证号">
                        <input type="text" placeholder="手机号">
                        <div class="select-box">
                            <input type="text" placeholder="公司名称">
                            <ul class="select">
                                <li>傲天科技</li>
                                <li>傲天科技有限公司</li>
                            </ul>
                        </div>
                        <input type="text" placeholder="部门/职位">
                    </dd>`;
            if(!!$('.main-visitor').length)$('.main-visitor').after($('<dl class="visitor">').html(_html));
            else $('.dl-idCard').after($('<dl class="visitor">').html(_html));
            var scroll_offset = $('.visitor').last().offset();
            $("body,html").animate({
                scrollTop: scroll_offset?scroll_offset.top : 0
            })
        })

        $('.add_visitor_pop #close,.add_visitor_pop button').click(function(){
            $('.add_visitor_pop').hide();
            $('.mask').hide();
        })

    //删除访客
        $('body').delegate('.delete','click',function(){
            var scroll_offset = $(this).parent().parent().prev().offset();
            $("body,html").animate({
                scrollTop:scroll_offset.top
            })
            $(this).parent().parent().animate({
                height:0
            },300)
            var timer = setTimeout(()=>{
                clearTimeout(timer)
                $(this).parent().parent().remove();
            },300)
        })
</script>
</html>